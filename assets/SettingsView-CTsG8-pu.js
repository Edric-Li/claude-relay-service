import{aP as Fe,r as k,aX as je,c as ve,o as xe,q as Pe,Z as Le,x as o,z as t,L as b,C as j,O as l,u as f,K as i,S as Z,aq as x,al as P,P as v,aT as A,Q as R,ac as _,aV as Q,R as Oe,J as Re,T as Qe,Y as Ne,y as n}from"./vue-vendor-R8HMg95E.js";import{c as S,_ as We,s as c}from"./index-B-HRUVpK.js";import"./element-plus-BQHxDbdW.js";import"./vendor-Dr8jvgFu.js";const Ke=Fe("settings",()=>{const I=k({siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",showAdminButton:!0,updatedAt:null}),M=k(!1),N=k(!1),B=async()=>{M.value=!0;try{const g=await S.get("/admin/oem-settings");return g&&g.success&&(I.value={...I.value,...g.data},T()),g}catch(g){throw console.error("Failed to load OEM settings:",g),g}finally{M.value=!1}},p=async g=>{N.value=!0;try{const m=await S.put("/admin/oem-settings",g);return m&&m.success&&(I.value={...I.value,...m.data},T()),m}catch(m){throw console.error("Failed to save OEM settings:",m),m}finally{N.value=!1}},X=async()=>{const g={siteName:"Claude Relay Service",siteIcon:"",siteIconData:"",showAdminButton:!0,updatedAt:null};return I.value={...g},await p(g)},T=()=>{if(I.value.siteName&&(document.title=`${I.value.siteName} - 管理后台`),I.value.siteIconData||I.value.siteIcon){const g=document.querySelector('link[rel="icon"]')||document.createElement("link");g.rel="icon",g.href=I.value.siteIconData||I.value.siteIcon,document.querySelector('link[rel="icon"]')||document.head.appendChild(g)}};return{oemSettings:I,loading:M,saving:N,loadOemSettings:B,saveOemSettings:p,resetOemSettings:X,applyOemSettings:T,formatDateTime:g=>g?new Date(g).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"",validateIconFile:g=>{const m=[];return g.size>350*1024&&m.push("图标文件大小不能超过 350KB"),["image/x-icon","image/png","image/jpeg","image/jpg","image/svg+xml"].includes(g.type)||m.push("不支持的文件类型，请选择 .ico, .png, .jpg 或 .svg 文件"),{isValid:m.length===0,errors:m}},fileToBase64:g=>new Promise((m,F)=>{const D=new FileReader;D.onload=W=>m(W.target.result),D.onerror=F,D.readAsDataURL(g)})}}),$e={class:"settings-container"},qe={class:"card p-4 sm:p-6"},ze={class:"mb-6"},He={class:"flex space-x-8"},Je={key:0,class:"py-12 text-center"},Xe={key:1},Ye={class:"table-container hidden sm:block"},Ge={class:"min-w-full"},Ze={class:"divide-y divide-gray-200/50 dark:divide-gray-600/50"},_e={class:"table-row"},et={class:"px-6 py-4"},tt={class:"table-row"},at={class:"px-6 py-4"},rt={class:"space-y-3"},st={key:0,class:"inline-flex items-center gap-3 rounded-lg bg-gray-50 p-3 dark:bg-gray-700"},lt=["src"],ot={class:"table-row"},nt={class:"px-6 py-4"},dt={class:"flex items-center"},it={class:"inline-flex cursor-pointer items-center"},ut={class:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300"},ct={class:"px-6 py-6",colspan:"2"},gt={class:"flex items-center justify-between"},bt={class:"flex gap-3"},ft=["disabled"],pt={key:0,class:"loading-spinner mr-2"},yt={key:1,class:"fas fa-save mr-2"},vt=["disabled"],xt={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},mt={class:"space-y-4 sm:hidden"},kt={class:"glass-card p-4"},ht={class:"glass-card p-4"},wt={class:"space-y-3"},Ct={key:0,class:"inline-flex items-center gap-3 rounded-lg bg-gray-50 p-3 dark:bg-gray-700"},Tt=["src"],Ut={class:"glass-card p-4"},At={class:"space-y-2"},St={class:"inline-flex cursor-pointer items-center"},It={class:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300"},Bt={class:"glass-card p-4"},Et={class:"flex flex-col gap-3"},Mt=["disabled"],Dt={key:0,class:"loading-spinner mr-2"},Vt={key:1,class:"fas fa-save mr-2"},Ft=["disabled"],jt={key:0,class:"text-center text-sm text-gray-500 dark:text-gray-400"},Pt={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Lt={class:"flex items-center justify-between"},Ot={class:"relative inline-flex cursor-pointer items-center"},Rt={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Qt={class:"space-y-3"},Nt={class:"font-medium text-gray-700 dark:text-gray-300"},Wt={class:"ml-2 text-sm text-gray-500 dark:text-gray-400"},Kt={class:"relative inline-flex cursor-pointer items-center"},$t=["onUpdate:modelValue"],qt={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},zt={class:"mb-4 flex items-center justify-between"},Ht={key:0,class:"space-y-4"},Jt={class:"flex items-start justify-between"},Xt={class:"flex-1"},Yt={class:"flex items-center"},Gt={class:"font-semibold text-gray-800 dark:text-gray-200"},Zt={class:"text-sm text-gray-500 dark:text-gray-400"},_t={class:"mt-3 space-y-1 text-sm"},ea={key:0,class:"flex items-center text-gray-600 dark:text-gray-400"},ta={class:"truncate"},aa={key:1,class:"flex items-center text-gray-600 dark:text-gray-400"},ra={class:"truncate"},sa={key:2,class:"flex items-center text-gray-600 dark:text-gray-400"},la={class:"truncate"},oa={key:3,class:"flex items-center text-gray-600 dark:text-gray-400"},na={class:"truncate"},da={key:4,class:"flex items-center text-gray-600 dark:text-gray-400"},ia={class:"truncate"},ua={key:5,class:"flex items-center text-gray-600 dark:text-gray-400"},ca={class:"truncate"},ga={key:6,class:"flex items-center text-gray-600 dark:text-gray-400"},ba={class:"ml-4 flex items-center space-x-2"},fa={class:"relative inline-flex cursor-pointer items-center"},pa=["checked","onChange"],ya=["onClick"],va=["onClick"],xa=["onClick"],ma={key:1,class:"py-8 text-center text-gray-500 dark:text-gray-400"},ka={class:"rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},ha={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},wa={key:0,class:"py-12 text-center"},Ca={key:1},Ta={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Ua={class:"flex items-center justify-between"},Aa={class:"relative inline-flex cursor-pointer items-center"},Sa={key:0,class:"mt-6 border-t border-gray-200 pt-6 dark:border-gray-600"},Ia={class:"flex items-center justify-between"},Ba={class:"relative inline-flex cursor-pointer items-center"},Ea={key:0,class:"mt-4 space-y-4 rounded-lg bg-gray-50 p-4 dark:bg-gray-700/50"},Ma={key:0},Da={class:"relative mt-1"},Va=["disabled"],Fa={value:""},ja=["value"],Pa={key:0,class:"pointer-events-none absolute inset-y-0 right-8 flex items-center"},La={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Oa={class:"flex items-center justify-between"},Ra={class:"relative inline-flex cursor-pointer items-center"},Qa={key:0,class:"mt-6 space-y-4"},Na={class:"mb-6 rounded-lg bg-white/80 p-6 shadow-lg backdrop-blur-sm dark:bg-gray-800/80"},Wa={class:"flex items-center justify-between"},Ka={class:"relative inline-flex cursor-pointer items-center"},$a={key:0,class:"mt-6 space-y-4"},qa={key:0,class:"rounded-lg bg-gray-50 p-4 text-sm text-gray-500 dark:bg-gray-700/50 dark:text-gray-400"},za={key:0,class:"ml-2"},Ha={class:"dark:to-gray-750 relative border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-5 dark:border-gray-700 dark:from-gray-800"},Ja={class:"flex items-center justify-between"},Xa={class:"flex items-center space-x-3"},Ya={class:"text-xl font-semibold text-gray-900 dark:text-white"},Ga={class:"mt-0.5 text-sm text-gray-600 dark:text-gray-400"},Za={class:"p-6"},_a={class:"space-y-5"},er={class:"relative"},tr=["disabled"],ar={key:0,class:"mt-1 text-xs text-amber-600 dark:text-amber-400"},rr={key:0},sr={class:"relative"},lr={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},or={key:1,class:"absolute inset-y-0 right-0 flex items-center pr-3"},nr={key:0,class:"mt-2 flex items-start rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},dr={class:"text-sm text-blue-700 dark:text-blue-300"},ir={key:1,class:"space-y-5"},ur={key:2,class:"space-y-5"},cr={key:3,class:"space-y-5"},gr={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},br={key:4,class:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900/50"},fr={class:"space-y-4"},pr={class:"flex items-center justify-between"},yr={class:"flex cursor-pointer items-center",for:"enableSign"},vr={key:0,class:"rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-700 dark:bg-green-900/50 dark:text-green-400"},xr={key:0},mr={class:"border-t border-gray-200 bg-gray-50 px-6 py-4 dark:border-gray-700 dark:bg-gray-900/50"},kr={class:"flex items-center justify-between"},hr={class:"flex space-x-3"},wr=["disabled"],Cr=["disabled"],Tr=Object.assign({name:"SettingsView"},{__name:"SettingsView",setup(I){const M=Ke(),{loading:N,saving:B,oemSettings:p}=je(M),X=k(),T=k("branding"),u=k(!0),U=k(new AbortController),L=ve({get(){return!p.value.showAdminButton},set(r){p.value.showAdminButton=!r}}),g=k(!1),m=k(!1),F=k(!1),D=k(!1),W={accountAnomaly:!0,quotaWarning:!0,systemError:!0,securityAlert:!0,rateLimitRecovery:!0},h=k({enabled:!1,platforms:[],notificationTypes:{...W},retrySettings:{maxRetries:3,retryDelay:1e3,timeout:1e4}}),Y=k(!1),d=k({claudeCodeOnlyEnabled:!1,globalSessionBindingEnabled:!1,sessionBindingErrorMessage:"你的本地session已污染，请清理后使用。",sessionBindingTtlDays:30,nonClaudeCodeFallbackEnabled:!1,nonClaudeCodeFallbackAccountId:null,nonClaudeCodeFallbackAccountType:null,userMessageQueueEnabled:!0,userMessageQueueDelayMs:200,userMessageQueueTimeoutMs:3e4,updatedAt:null,updatedBy:null}),K=k(!1),z=k([]),O=k(!1),E=k(null),a=k({type:"wechat_work",name:"",url:"",enableSign:!1,secret:"",botToken:"",chatId:"",apiBaseUrl:"",proxyUrl:"",deviceKey:"",serverUrl:"",level:"",sound:"",group:"",host:"",port:null,secure:!1,user:"",pass:"",from:"",to:"",timeout:null,ignoreTLS:!1}),ee=xe(T,async r=>{u.value&&(r==="webhook"?await $():r==="claude"&&await ke())}),te=xe(()=>a.value.type,r=>{g.value=!1,m.value=!1,E.value||(r==="bark"?(a.value.url="",a.value.enableSign=!1,a.value.secret="",a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl="",a.value.host="",a.value.port=null,a.value.secure=!1,a.value.user="",a.value.pass="",a.value.from="",a.value.to="",a.value.timeout=null,a.value.ignoreTLS=!1):r==="smtp"?(a.value.url="",a.value.enableSign=!1,a.value.secret="",a.value.deviceKey="",a.value.serverUrl="",a.value.level="",a.value.sound="",a.value.group="",a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl=""):r==="telegram"?(a.value.url="",a.value.enableSign=!1,a.value.secret="",a.value.deviceKey="",a.value.serverUrl="",a.value.level="",a.value.sound="",a.value.group="",a.value.host="",a.value.port=null,a.value.secure=!1,a.value.user="",a.value.pass="",a.value.from="",a.value.to="",a.value.timeout=null,a.value.ignoreTLS=!1,a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl=""):(a.value.deviceKey="",a.value.serverUrl="",a.value.level="",a.value.sound="",a.value.group="",a.value.host="",a.value.port=null,a.value.secure=!1,a.value.user="",a.value.pass="",a.value.from="",a.value.to="",a.value.timeout=null,a.value.ignoreTLS=!1,a.value.botToken="",a.value.chatId="",a.value.apiBaseUrl="",a.value.proxyUrl=""))}),me=ve(()=>a.value.type==="bark"?!!a.value.deviceKey:a.value.type==="telegram"?!!(a.value.botToken&&a.value.chatId):a.value.type==="smtp"?!!(a.value.host&&a.value.user&&a.value.pass&&a.value.to):!!a.value.url&&!g.value);Pe(async()=>{try{await M.loadOemSettings(),T.value==="webhook"&&await $()}catch{c("加载设置失败","error")}}),Le(()=>{u.value=!1,U.value&&U.value.abort(),ee&&ee(),te&&te(),O.value&&(O.value=!1,E.value=null)});const $=async()=>{if(u.value)try{const r=await S.get("/admin/webhook/config",{signal:U.value.signal});if(r.success&&u.value){const e=r.config||{};h.value={...e,notificationTypes:{...W,...e.notificationTypes||{}}}}}catch(r){if(r.name==="AbortError"||!u.value)return;c("获取webhook配置失败","error"),console.error(r)}},q=async()=>{if(u.value)try{const r={...h.value,notificationTypes:{...W,...h.value.notificationTypes||{}}};(await S.post("/admin/webhook/config",r,{signal:U.value.signal})).success&&u.value&&(h.value=r,c("配置已保存","success"))}catch(r){if(r.name==="AbortError"||!u.value)return;c("保存配置失败","error"),console.error(r)}},ke=async()=>{var r,e,s,y,w,J,ce,ge,be,fe,pe,ye;if(u.value){Y.value=!0;try{const C=await S.get("/admin/claude-relay-config",{signal:U.value.signal});C.success&&u.value&&(d.value={claudeCodeOnlyEnabled:((r=C.config)==null?void 0:r.claudeCodeOnlyEnabled)??!1,globalSessionBindingEnabled:((e=C.config)==null?void 0:e.globalSessionBindingEnabled)??!1,sessionBindingErrorMessage:((s=C.config)==null?void 0:s.sessionBindingErrorMessage)||"你的本地session已污染，请清理后使用。",sessionBindingTtlDays:((y=C.config)==null?void 0:y.sessionBindingTtlDays)??30,nonClaudeCodeFallbackEnabled:((w=C.config)==null?void 0:w.nonClaudeCodeFallbackEnabled)??!1,nonClaudeCodeFallbackAccountId:((J=C.config)==null?void 0:J.nonClaudeCodeFallbackAccountId)||null,nonClaudeCodeFallbackAccountType:((ce=C.config)==null?void 0:ce.nonClaudeCodeFallbackAccountType)||null,userMessageQueueEnabled:((ge=C.config)==null?void 0:ge.userMessageQueueEnabled)??!0,userMessageQueueDelayMs:((be=C.config)==null?void 0:be.userMessageQueueDelayMs)??200,userMessageQueueTimeoutMs:((fe=C.config)==null?void 0:fe.userMessageQueueTimeoutMs)??3e4,updatedAt:((pe=C.config)==null?void 0:pe.updatedAt)||null,updatedBy:((ye=C.config)==null?void 0:ye.updatedBy)||null},d.value.nonClaudeCodeFallbackAccountType&&ae(d.value.nonClaudeCodeFallbackAccountType))}catch(C){if(C.name==="AbortError"||!u.value)return;c("获取 Claude 转发配置失败","error"),console.error(C)}finally{u.value&&(Y.value=!1)}}},V=async()=>{var r,e;if(u.value)try{const s={claudeCodeOnlyEnabled:d.value.claudeCodeOnlyEnabled,globalSessionBindingEnabled:d.value.globalSessionBindingEnabled,sessionBindingErrorMessage:d.value.sessionBindingErrorMessage,sessionBindingTtlDays:d.value.sessionBindingTtlDays,nonClaudeCodeFallbackEnabled:d.value.nonClaudeCodeFallbackEnabled,nonClaudeCodeFallbackAccountId:d.value.nonClaudeCodeFallbackAccountId,nonClaudeCodeFallbackAccountType:d.value.nonClaudeCodeFallbackAccountType,userMessageQueueEnabled:d.value.userMessageQueueEnabled,userMessageQueueDelayMs:d.value.userMessageQueueDelayMs,userMessageQueueTimeoutMs:d.value.userMessageQueueTimeoutMs},y=await S.put("/admin/claude-relay-config",s,{signal:U.value.signal});y.success&&u.value&&(d.value={...d.value,updatedAt:((r=y.config)==null?void 0:r.updatedAt)||new Date().toISOString(),updatedBy:((e=y.config)==null?void 0:e.updatedBy)||null},c("Claude 转发配置已保存","success"))}catch(s){if(s.name==="AbortError"||!u.value)return;c("保存 Claude 转发配置失败","error"),console.error(s)}},he=async()=>{d.value.nonClaudeCodeFallbackAccountId=null,z.value=[],d.value.nonClaudeCodeFallbackAccountType&&await ae(d.value.nonClaudeCodeFallbackAccountType),V()},ae=async r=>{if(u.value){K.value=!0,z.value=[];try{let e="";switch(r){case"claude-official":e="/admin/claude-accounts";break;case"claude-console":e="/admin/claude-console-accounts";break;case"bedrock":e="/admin/bedrock-accounts";break;case"ccr":e="/admin/ccr-accounts";break;default:return}const s=await S.get(e,{signal:U.value.signal});if(u.value){const y=s.accounts||s.data||s||[];z.value=Array.isArray(y)?y:[]}}catch(e){if(e.name==="AbortError"||!u.value)return;c("加载账户列表失败","error"),console.error(e)}finally{u.value&&(K.value=!1)}}},we=()=>{if(["bark","smtp","telegram"].includes(a.value.type)){g.value=!1,m.value=!1;return}const r=a.value.url;if(!r){g.value=!1,m.value=!1;return}try{new URL(r),r.startsWith("http://")||r.startsWith("https://")?(g.value=!1,m.value=!0):(g.value=!0,m.value=!1)}catch{g.value=!0,m.value=!1}},re=()=>{if(a.value.type==="bark"){if(!a.value.deviceKey)return c("请输入Bark设备密钥","error"),!1}else if(a.value.type==="telegram"){if(!a.value.botToken)return c("请输入 Telegram 机器人 Token","error"),!1;if(!a.value.chatId)return c("请输入 Telegram Chat ID","error"),!1;if(a.value.apiBaseUrl)try{const r=new URL(a.value.apiBaseUrl);if(!["http:","https:"].includes(r.protocol))return c("Telegram API 基础地址仅支持 http 或 https","error"),!1}catch{return c("请输入有效的 Telegram API 基础地址","error"),!1}if(a.value.proxyUrl)try{const r=new URL(a.value.proxyUrl);if(!["http:","https:","socks4:","socks4a:","socks5:"].includes(r.protocol))return c("Telegram 代理仅支持 http/https/socks 协议","error"),!1}catch{return c("请输入有效的 Telegram 代理地址","error"),!1}}else if(a.value.type==="smtp"){const r=[{field:"host",message:"SMTP服务器"},{field:"user",message:"用户名"},{field:"pass",message:"密码"},{field:"to",message:"收件人邮箱"}];for(const{field:e,message:s}of r)if(!a.value[e])return c(`请输入${s}`,"error"),!1}else{if(!a.value.url)return c("请输入Webhook URL","error"),!1;if(g.value)return c("请输入有效的Webhook URL","error"),!1}return!0},Ce=async()=>{if(u.value&&re()){D.value=!0;try{let r;E.value?r=await S.put(`/admin/webhook/platforms/${E.value.id}`,a.value,{signal:U.value.signal}):r=await S.post("/admin/webhook/platforms",a.value,{signal:U.value.signal}),r.success&&u.value&&(c(E.value?"平台已更新":"平台已添加","success"),await $(),H())}catch(r){if(r.name==="AbortError"||!u.value)return;c(r.message||"操作失败","error"),console.error(r)}finally{u.value&&(D.value=!1)}}},Te=r=>{E.value=r,a.value={type:r.type||"wechat_work",name:r.name||"",url:r.url||"",enableSign:r.enableSign||!1,secret:r.secret||"",botToken:r.botToken||"",chatId:r.chatId||"",apiBaseUrl:r.apiBaseUrl||"",proxyUrl:r.proxyUrl||"",deviceKey:r.deviceKey||"",serverUrl:r.serverUrl||"",level:r.level||"",sound:r.sound||"",group:r.group||"",host:r.host||"",port:r.port??null,secure:r.secure||!1,user:r.user||"",pass:r.pass||"",from:r.from||"",to:Array.isArray(r.to)?r.to.join(", "):r.to||"",timeout:r.timeout??null,ignoreTLS:r.ignoreTLS||!1},O.value=!0},Ue=async r=>{if(u.value&&confirm("确定要删除这个平台吗？"))try{(await S.delete(`/admin/webhook/platforms/${r}`,{signal:U.value.signal})).success&&u.value&&(c("平台已删除","success"),await $())}catch(e){if(e.name==="AbortError"||!u.value)return;c("删除失败","error"),console.error(e)}},Ae=async r=>{if(u.value)try{const e=await S.post(`/admin/webhook/platforms/${r}/toggle`,{},{signal:U.value.signal});e.success&&u.value&&(c(e.message,"success"),await $())}catch(e){if(e.name==="AbortError"||!u.value)return;c("操作失败","error"),console.error(e)}},Se=async r=>{if(u.value)try{const e={type:r.type,secret:r.secret,enableSign:r.enableSign};r.type==="bark"?(e.deviceKey=r.deviceKey,e.serverUrl=r.serverUrl,e.level=r.level,e.sound=r.sound,e.group=r.group):r.type==="smtp"?(e.host=r.host,e.port=r.port,e.secure=r.secure,e.user=r.user,e.pass=r.pass,e.from=r.from,e.to=r.to,e.ignoreTLS=r.ignoreTLS):r.type==="telegram"?(e.botToken=r.botToken,e.chatId=r.chatId,e.apiBaseUrl=r.apiBaseUrl,e.proxyUrl=r.proxyUrl):e.url=r.url,(await S.post("/admin/webhook/test",e,{signal:U.value.signal})).success&&u.value&&c("测试成功","success")}catch(e){if(e.name==="AbortError"||!u.value)return;c(e.error||e.message||"测试失败","error"),console.error(e)}},Ie=async()=>{if(u.value&&re()){F.value=!0;try{(await S.post("/admin/webhook/test",a.value,{signal:U.value.signal})).success&&u.value&&c("测试成功","success")}catch(r){if(r.name==="AbortError"||!u.value)return;c(r.error||r.message||"测试失败","error"),console.error(r)}finally{u.value&&(F.value=!1)}}},Be=async()=>{var r,e,s,y;if(u.value)try{(await S.post("/admin/webhook/test-notification",{},{signal:U.value.signal})).success&&u.value&&c("测试通知已发送","success")}catch(w){if(w.name==="AbortError"||!u.value)return;const J=((e=(r=w==null?void 0:w.response)==null?void 0:r.data)==null?void 0:e.message)||((y=(s=w==null?void 0:w.response)==null?void 0:s.data)==null?void 0:y.error)||(w==null?void 0:w.message)||"发送失败";c(J,"error"),console.error(w)}},H=()=>{u.value&&(O.value=!1,setTimeout(()=>{u.value&&(E.value=null,a.value={type:"wechat_work",name:"",url:"",enableSign:!1,secret:"",botToken:"",chatId:"",apiBaseUrl:"",proxyUrl:"",deviceKey:"",serverUrl:"",level:"",sound:"",group:"",host:"",port:null,secure:!1,user:"",pass:"",from:"",to:"",timeout:null,ignoreTLS:!1},g.value=!1,m.value=!1,F.value=!1,D.value=!1)},0))},se=r=>({wechat_work:"企业微信",dingtalk:"钉钉",feishu:"飞书",slack:"Slack",discord:"Discord",telegram:"Telegram",bark:"Bark",smtp:"邮件通知",custom:"自定义"})[r]||r,Ee=r=>({wechat_work:"fab fa-weixin text-green-600",dingtalk:"fas fa-comment-dots text-blue-500",feishu:"fas fa-dove text-blue-600",slack:"fab fa-slack text-purple-600",discord:"fab fa-discord text-indigo-600",telegram:"fab fa-telegram-plane text-sky-500",bark:"fas fa-bell text-orange-500",smtp:"fas fa-envelope text-blue-600",custom:"fas fa-webhook text-gray-600"})[r]||"fas fa-bell",le=r=>({wechat_work:"请在企业微信群机器人设置中获取Webhook地址",dingtalk:"请在钉钉群机器人设置中获取Webhook地址",feishu:"请在飞书群机器人设置中获取Webhook地址",slack:"请在Slack应用的Incoming Webhooks中获取地址",discord:"请在Discord服务器的集成设置中创建Webhook",telegram:"使用 @BotFather 创建机器人并复制 Token，Chat ID 可通过 @userinfobot 或相关工具获取",bark:"请在Bark App中查看您的设备密钥",smtp:"请配置SMTP服务器信息，支持Gmail、QQ邮箱等",custom:"请输入完整的Webhook接收地址"})[r]||"",Me=r=>r?r.length<=12?r:`${r.slice(0,6)}...${r.slice(-4)}`:"",De=r=>({accountAnomaly:"账号异常",quotaWarning:"配额警告",systemError:"系统错误",securityAlert:"安全警报",rateLimitRecovery:"限流恢复",test:"测试通知"})[r]||r,Ve=r=>({accountAnomaly:"账号状态异常、认证失败等",quotaWarning:"API调用配额不足警告",systemError:"系统运行错误和故障",securityAlert:"安全相关的警报通知",rateLimitRecovery:"限流状态恢复时发送提醒",test:"用于测试Webhook连接是否正常"})[r]||"",oe=async()=>{try{const r={siteName:p.value.siteName,siteIcon:p.value.siteIcon,siteIconData:p.value.siteIconData,showAdminButton:p.value.showAdminButton},e=await M.saveOemSettings(r);e&&e.success?c("OEM设置保存成功","success"):c((e==null?void 0:e.message)||"保存失败","error")}catch{c("保存OEM设置失败","error")}},ne=async()=>{if(confirm(`确定要重置为默认设置吗？

这将清除所有自定义的网站名称和图标设置。`))try{const r=await M.resetOemSettings();r&&r.success?c("已重置为默认设置","success"):c("重置失败","error")}catch{c("重置失败","error")}},de=async r=>{const e=r.target.files[0];if(!e)return;const s=M.validateIconFile(e);if(!s.isValid){s.errors.forEach(y=>c(y,"error"));return}try{const y=await M.fileToBase64(e);p.value.siteIconData=y}catch{c("文件读取失败","error")}r.target.value=""},ie=()=>{p.value.siteIcon="",p.value.siteIconData=""},ue=()=>{console.warn("Icon failed to load")},G=M.formatDateTime;return(r,e)=>(n(),o(R,null,[t("div",$e,[t("div",qe,[e[123]||(e[123]=t("div",{class:"mb-4 sm:mb-6"},[t("h3",{class:"mb-1 text-lg font-bold text-gray-900 dark:text-gray-100 sm:mb-2 sm:text-xl"}," 系统设置 "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400 sm:text-base"},"网站定制和通知配置")],-1)),t("div",ze,[t("nav",He,[t("button",{class:j(["border-b-2 pb-2 text-sm font-medium transition-colors",T.value==="branding"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:e[0]||(e[0]=s=>T.value="branding")},e[46]||(e[46]=[t("i",{class:"fas fa-palette mr-2"},null,-1),l(" 品牌设置 ",-1)]),2),t("button",{class:j(["border-b-2 pb-2 text-sm font-medium transition-colors",T.value==="webhook"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:e[1]||(e[1]=s=>T.value="webhook")},e[47]||(e[47]=[t("i",{class:"fas fa-bell mr-2"},null,-1),l(" 通知设置 ",-1)]),2),t("button",{class:j(["border-b-2 pb-2 text-sm font-medium transition-colors",T.value==="claude"?"border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"]),onClick:e[2]||(e[2]=s=>T.value="claude")},e[48]||(e[48]=[t("i",{class:"fas fa-robot mr-2"},null,-1),l(" Claude 转发 ",-1)]),2)])]),f(N)?(n(),o("div",Je,e[49]||(e[49]=[t("div",{class:"loading-spinner mx-auto mb-4"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载设置...",-1)]))):(n(),o("div",Xe,[i(t("div",null,[t("div",Ye,[t("table",Ge,[t("tbody",Ze,[t("tr",_e,[e[51]||(e[51]=t("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[t("div",{class:"flex items-center"},[t("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-blue-600"},[t("i",{class:"fas fa-font text-xs text-white"})]),t("div",null,[t("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 网站名称 "),t("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"品牌标识")])])],-1)),t("td",et,[i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>f(p).siteName=s),class:"form-input w-full max-w-md dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",maxlength:"100",placeholder:"Claude Relay Service",type:"text"},null,512),[[x,f(p).siteName]]),e[50]||(e[50]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 将显示在浏览器标题和页面头部 ",-1))])]),t("tr",tt,[e[56]||(e[56]=t("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[t("div",{class:"flex items-center"},[t("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-purple-500 to-purple-600"},[t("i",{class:"fas fa-image text-xs text-white"})]),t("div",null,[t("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 网站图标 "),t("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"Favicon")])])],-1)),t("td",at,[t("div",rt,[f(p).siteIconData||f(p).siteIcon?(n(),o("div",st,[t("img",{alt:"图标预览",class:"h-8 w-8",src:f(p).siteIconData||f(p).siteIcon,onError:ue},null,40,lt),e[53]||(e[53]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"当前图标",-1)),t("button",{class:"rounded-lg px-3 py-1 font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-900",onClick:ie},e[52]||(e[52]=[t("i",{class:"fas fa-trash mr-1"},null,-1),l("删除 ",-1)]))])):b("",!0),t("div",null,[t("input",{ref_key:"iconFileInput",ref:X,accept:".ico,.png,.jpg,.jpeg,.svg",class:"hidden",type:"file",onChange:de},null,544),t("button",{class:"btn btn-success px-4 py-2",onClick:e[4]||(e[4]=s=>r.$refs.iconFileInput.click())},e[54]||(e[54]=[t("i",{class:"fas fa-upload mr-2"},null,-1),l(" 上传图标 ",-1)])),e[55]||(e[55]=t("span",{class:"ml-3 text-xs text-gray-500 dark:text-gray-400"},"支持 .ico, .png, .jpg, .svg 格式，最大 350KB",-1))])])])]),t("tr",ot,[e[59]||(e[59]=t("td",{class:"w-48 whitespace-nowrap px-6 py-4"},[t("div",{class:"flex items-center"},[t("div",{class:"mr-3 flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600"},[t("i",{class:"fas fa-eye-slash text-xs text-white"})]),t("div",null,[t("div",{class:"text-sm font-semibold text-gray-900 dark:text-gray-100"}," 管理入口 "),t("div",{class:"text-xs text-gray-500 dark:text-gray-400"},"登录按钮显示")])])],-1)),t("td",nt,[t("div",dt,[t("label",it,[i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>L.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[P,L.value]]),e[57]||(e[57]=t("div",{class:"peer relative h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1)),t("span",ut,v(L.value?"隐藏登录按钮":"显示登录按钮"),1)])]),e[58]||(e[58]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 隐藏后，用户需要直接访问 /admin/login 页面登录 ",-1))])]),t("tr",null,[t("td",ct,[t("div",gt,[t("div",bt,[t("button",{class:j(["btn btn-primary px-6 py-3",{"cursor-not-allowed opacity-50":f(B)}]),disabled:f(B),onClick:oe},[f(B)?(n(),o("div",pt)):(n(),o("i",yt)),l(" "+v(f(B)?"保存中...":"保存设置"),1)],10,ft),t("button",{class:"btn bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:f(B),onClick:ne},e[60]||(e[60]=[t("i",{class:"fas fa-undo mr-2"},null,-1),l(" 重置为默认 ",-1)]),8,vt)]),f(p).updatedAt?(n(),o("div",xt,[e[61]||(e[61]=t("i",{class:"fas fa-clock mr-1"},null,-1)),l(" 最后更新："+v(f(G)(f(p).updatedAt)),1)])):b("",!0)])])])])])]),t("div",mt,[t("div",kt,[e[62]||(e[62]=A('<div class="mb-3 flex items-center gap-3" data-v-4daca4cb><div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-cyan-600 text-white shadow-md" data-v-4daca4cb><i class="fas fa-tag" data-v-4daca4cb></i></div><div data-v-4daca4cb><h3 class="text-base font-semibold text-gray-900 dark:text-gray-100" data-v-4daca4cb>站点名称</h3><p class="text-sm text-gray-500 dark:text-gray-400" data-v-4daca4cb>自定义您的站点品牌名称</p></div></div>',1)),i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>f(p).siteName=s),class:"form-input w-full dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200",maxlength:"100",placeholder:"Claude Relay Service",type:"text"},null,512),[[x,f(p).siteName]])]),t("div",ht,[e[66]||(e[66]=A('<div class="mb-3 flex items-center gap-3" data-v-4daca4cb><div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-purple-500 to-pink-600 text-white shadow-md" data-v-4daca4cb><i class="fas fa-image" data-v-4daca4cb></i></div><div data-v-4daca4cb><h3 class="text-base font-semibold text-gray-900 dark:text-gray-100" data-v-4daca4cb>站点图标</h3><p class="text-sm text-gray-500 dark:text-gray-400" data-v-4daca4cb> 上传自定义图标或输入图标URL </p></div></div>',1)),t("div",wt,[f(p).siteIconData||f(p).siteIcon?(n(),o("div",Ct,[t("img",{alt:"图标预览",class:"h-8 w-8",src:f(p).siteIconData||f(p).siteIcon,onError:ue},null,40,Tt),e[63]||(e[63]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"当前图标",-1)),t("button",{class:"rounded-lg px-3 py-1 font-medium text-red-600 transition-colors hover:bg-red-50 hover:text-red-900",onClick:ie}," 删除 ")])):b("",!0),t("div",null,[t("input",{ref:"iconFileInputMobile",accept:".ico,.png,.jpg,.jpeg,.svg",class:"hidden",type:"file",onChange:de},null,544),t("button",{class:"btn btn-success px-4 py-2",onClick:e[7]||(e[7]=s=>r.$refs.iconFileInputMobile.click())},e[64]||(e[64]=[t("i",{class:"fas fa-upload mr-2"},null,-1),l(" 上传图标 ",-1)])),e[65]||(e[65]=t("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"}," 支持 .ico, .png, .jpg, .svg 格式，最大 350KB ",-1))])])]),t("div",Ut,[e[69]||(e[69]=A('<div class="mb-3 flex items-center gap-3" data-v-4daca4cb><div class="flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-md" data-v-4daca4cb><i class="fas fa-eye-slash" data-v-4daca4cb></i></div><div data-v-4daca4cb><h3 class="text-base font-semibold text-gray-900 dark:text-gray-100" data-v-4daca4cb>管理入口</h3><p class="text-sm text-gray-500 dark:text-gray-400" data-v-4daca4cb>控制登录按钮在首页的显示</p></div></div>',1)),t("div",At,[t("label",St,[i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>L.value=s),class:"peer sr-only",type:"checkbox"},null,512),[[P,L.value]]),e[67]||(e[67]=t("div",{class:"peer relative h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1)),t("span",It,v(L.value?"隐藏登录按钮":"显示登录按钮"),1)]),e[68]||(e[68]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 隐藏后，用户需要直接访问 /admin/login 页面登录 ",-1))])]),t("div",Bt,[t("div",Et,[t("button",{class:j(["btn btn-primary w-full px-6 py-3",{"cursor-not-allowed opacity-50":f(B)}]),disabled:f(B),onClick:oe},[f(B)?(n(),o("div",Dt)):(n(),o("i",Vt)),l(" "+v(f(B)?"保存中...":"保存设置"),1)],10,Mt),t("button",{class:"btn w-full bg-gray-100 px-6 py-3 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",disabled:f(B),onClick:ne},e[70]||(e[70]=[t("i",{class:"fas fa-undo mr-2"},null,-1),l(" 重置为默认 ",-1)]),8,Ft),f(p).updatedAt?(n(),o("div",jt,[e[71]||(e[71]=t("i",{class:"fas fa-clock mr-1"},null,-1)),l(" 上次更新: "+v(f(G)(f(p).updatedAt)),1)])):b("",!0)])])])],512),[[Z,T.value==="branding"]]),i(t("div",null,[t("div",Pt,[t("div",Lt,[e[73]||(e[73]=t("div",null,[t("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"启用通知"),t("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 开启后，系统将按配置发送通知到指定平台 ")],-1)),t("label",Ot,[i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>h.value.enabled=s),class:"peer sr-only",type:"checkbox",onChange:q},null,544),[[P,h.value.enabled]]),e[72]||(e[72]=t("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-blue-800"},null,-1))])])]),t("div",Rt,[e[75]||(e[75]=t("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"通知类型",-1)),t("div",Qt,[(n(!0),o(R,null,_(h.value.notificationTypes,(s,y)=>(n(),o("div",{key:y,class:"flex items-center justify-between"},[t("div",null,[t("span",Nt,v(De(y)),1),t("span",Wt,v(Ve(y)),1)]),t("label",Kt,[i(t("input",{"onUpdate:modelValue":w=>h.value.notificationTypes[y]=w,class:"peer sr-only",type:"checkbox",onChange:q},null,40,$t),[[P,h.value.notificationTypes[y]]]),e[74]||(e[74]=t("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))])]))),128))])]),t("div",qt,[t("div",zt,[e[77]||(e[77]=t("h2",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"通知平台",-1)),t("button",{class:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",onClick:e[10]||(e[10]=s=>O.value=!0)},e[76]||(e[76]=[t("i",{class:"fas fa-plus mr-2"},null,-1),l(" 添加平台 ",-1)]))]),h.value.platforms&&h.value.platforms.length>0?(n(),o("div",Ht,[(n(!0),o(R,null,_(h.value.platforms,s=>(n(),o("div",{key:s.id,class:"rounded-lg border border-gray-200 p-4 dark:border-gray-700"},[t("div",Jt,[t("div",Xt,[t("div",Yt,[t("i",{class:j(["mr-3 text-xl",Ee(s.type)])},null,2),t("div",null,[t("h3",Gt,v(s.name||se(s.type)),1),t("p",Zt,v(se(s.type)),1)])]),t("div",_t,[s.type!=="smtp"&&s.type!=="telegram"?(n(),o("div",ea,[e[78]||(e[78]=t("i",{class:"fas fa-link mr-2"},null,-1)),t("span",ta,v(s.url),1)])):b("",!0),s.type==="telegram"?(n(),o("div",aa,[e[79]||(e[79]=t("i",{class:"fas fa-comments mr-2"},null,-1)),t("span",ra,"Chat ID: "+v(s.chatId||"未配置"),1)])):b("",!0),s.type==="telegram"&&s.botToken?(n(),o("div",sa,[e[80]||(e[80]=t("i",{class:"fas fa-key mr-2"},null,-1)),t("span",la,"Token: "+v(Me(s.botToken)),1)])):b("",!0),s.type==="telegram"&&s.apiBaseUrl?(n(),o("div",oa,[e[81]||(e[81]=t("i",{class:"fas fa-globe mr-2"},null,-1)),t("span",na,"API: "+v(s.apiBaseUrl),1)])):b("",!0),s.type==="telegram"&&s.proxyUrl?(n(),o("div",da,[e[82]||(e[82]=t("i",{class:"fas fa-route mr-2"},null,-1)),t("span",ia,"代理: "+v(s.proxyUrl),1)])):b("",!0),s.type==="smtp"&&s.to?(n(),o("div",ua,[e[83]||(e[83]=t("i",{class:"fas fa-envelope mr-2"},null,-1)),t("span",ca,v(Array.isArray(s.to)?s.to.join(", "):s.to),1)])):b("",!0),s.enableSign?(n(),o("div",ga,e[84]||(e[84]=[t("i",{class:"fas fa-shield-alt mr-2"},null,-1),t("span",null,"已启用签名验证",-1)]))):b("",!0)])]),t("div",ba,[t("label",fa,[t("input",{checked:s.enabled,class:"peer sr-only",type:"checkbox",onChange:y=>Ae(s.id)},null,40,pa),e[85]||(e[85]=t("div",{class:"peer h-5 w-9 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-green-600 peer-checked:after:translate-x-full peer-checked:after:border-white dark:border-gray-600 dark:bg-gray-700"},null,-1))]),t("button",{class:"rounded-lg bg-blue-100 p-2 text-blue-600 transition-colors hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-400 dark:hover:bg-blue-800",title:"测试连接",onClick:y=>Se(s)},e[86]||(e[86]=[t("i",{class:"fas fa-vial"},null,-1)]),8,ya),t("button",{class:"rounded-lg bg-gray-100 p-2 text-gray-600 transition-colors hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600",title:"编辑",onClick:y=>Te(s)},e[87]||(e[87]=[t("i",{class:"fas fa-edit"},null,-1)]),8,va),t("button",{class:"rounded-lg bg-red-100 p-2 text-red-600 transition-colors hover:bg-red-200 dark:bg-red-900 dark:text-red-400 dark:hover:bg-red-800",title:"删除",onClick:y=>Ue(s.id)},e[88]||(e[88]=[t("i",{class:"fas fa-trash"},null,-1)]),8,xa)])])]))),128))])):(n(),o("div",ma,' 暂无配置的通知平台，请点击"添加平台"按钮添加 '))]),t("div",ka,[e[92]||(e[92]=t("h2",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-gray-200"},"高级设置",-1)),t("div",ha,[t("div",null,[e[89]||(e[89]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 最大重试次数 ",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>h.value.retrySettings.maxRetries=s),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10",min:"0",type:"number",onChange:q},null,544),[[x,h.value.retrySettings.maxRetries,void 0,{number:!0}]])]),t("div",null,[e[90]||(e[90]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 重试延迟 (毫秒) ",-1)),i(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>h.value.retrySettings.retryDelay=s),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10000",min:"100",step:"100",type:"number",onChange:q},null,544),[[x,h.value.retrySettings.retryDelay,void 0,{number:!0}]])]),t("div",null,[e[91]||(e[91]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," 超时时间 (毫秒) ",-1)),i(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>h.value.retrySettings.timeout=s),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm",max:"30000",min:"1000",step:"1000",type:"number",onChange:q},null,544),[[x,h.value.retrySettings.timeout,void 0,{number:!0}]])])])]),t("div",{class:"mt-6 text-center"},[t("button",{class:"rounded-lg bg-green-600 px-6 py-3 text-white shadow-lg transition-all hover:bg-green-700 hover:shadow-xl",onClick:Be},e[93]||(e[93]=[t("i",{class:"fas fa-paper-plane mr-2"},null,-1),l(" 发送测试通知 ",-1)]))])],512),[[Z,T.value==="webhook"]]),i(t("div",null,[Y.value?(n(),o("div",wa,e[94]||(e[94]=[t("div",{class:"loading-spinner mx-auto mb-4"},null,-1),t("p",{class:"text-gray-500 dark:text-gray-400"},"正在加载配置...",-1)]))):(n(),o("div",Ca,[t("div",Ta,[t("div",Ua,[e[96]||(e[96]=A('<div data-v-4daca4cb><div class="flex items-center" data-v-4daca4cb><div class="mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-orange-500 to-amber-600 text-white shadow-lg" data-v-4daca4cb><i class="fas fa-terminal" data-v-4daca4cb></i></div><div data-v-4daca4cb><h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-4daca4cb> 仅允许 Claude Code 客户端 </h2><p class="mt-1 text-sm text-gray-600 dark:text-gray-400" data-v-4daca4cb> 启用后，所有 <code class="rounded bg-gray-100 px-1 dark:bg-gray-700" data-v-4daca4cb>/api/v1/messages</code> 和 <code class="rounded bg-gray-100 px-1 dark:bg-gray-700" data-v-4daca4cb>/claude/v1/messages</code> 端点将强制验证 Claude Code CLI 客户端 </p></div></div></div>',1)),t("label",Aa,[i(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>d.value.claudeCodeOnlyEnabled=s),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[P,d.value.claudeCodeOnlyEnabled]]),e[95]||(e[95]=t("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-orange-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-orange-800"},null,-1))])]),e[105]||(e[105]=A('<div class="mt-4 rounded-lg bg-amber-50 p-4 dark:bg-amber-900/20" data-v-4daca4cb><div class="flex" data-v-4daca4cb><i class="fas fa-info-circle mt-0.5 text-amber-500" data-v-4daca4cb></i><div class="ml-3" data-v-4daca4cb><p class="text-sm text-amber-700 dark:text-amber-300" data-v-4daca4cb> 此设置与 API Key 级别的客户端限制是 <strong data-v-4daca4cb>OR 逻辑</strong>：全局启用或 API Key 设置中启用，都会执行 Claude Code 验证。 </p></div></div></div>',1)),d.value.claudeCodeOnlyEnabled?(n(),o("div",Sa,[t("div",Ia,[e[98]||(e[98]=A('<div data-v-4daca4cb><div class="flex items-center" data-v-4daca4cb><div class="mr-3 flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-cyan-500 to-teal-600 text-white shadow-md" data-v-4daca4cb><i class="fas fa-random text-sm" data-v-4daca4cb></i></div><div data-v-4daca4cb><h3 class="text-base font-medium text-gray-800 dark:text-gray-200" data-v-4daca4cb> 启用降级账户 </h3><p class="mt-0.5 text-xs text-gray-600 dark:text-gray-400" data-v-4daca4cb> 非 Claude Code 客户端请求不直接拒绝，而是路由到指定账户 </p></div></div></div>',1)),t("label",Ba,[i(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>d.value.nonClaudeCodeFallbackEnabled=s),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[P,d.value.nonClaudeCodeFallbackEnabled]]),e[97]||(e[97]=t("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-teal-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-teal-800"},null,-1))])]),d.value.nonClaudeCodeFallbackEnabled?(n(),o("div",Ea,[t("div",null,[e[100]||(e[100]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-layer-group mr-2 text-gray-400"}),l(" 账户类型 ")],-1)),i(t("select",{"onUpdate:modelValue":e[16]||(e[16]=s=>d.value.nonClaudeCodeFallbackAccountType=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-teal-500 focus:outline-none focus:ring-2 focus:ring-teal-500/20 dark:border-gray-500 dark:bg-gray-600 dark:text-white sm:text-sm",onChange:he},e[99]||(e[99]=[A('<option value="" data-v-4daca4cb>请选择账户类型</option><option value="claude-official" data-v-4daca4cb>Claude 官方账户</option><option value="claude-console" data-v-4daca4cb>Claude Console 账户</option><option value="bedrock" data-v-4daca4cb>AWS Bedrock 账户</option><option value="ccr" data-v-4daca4cb>CCR 账户</option>',5)]),544),[[Q,d.value.nonClaudeCodeFallbackAccountType]])]),d.value.nonClaudeCodeFallbackAccountType?(n(),o("div",Ma,[e[102]||(e[102]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-user-circle mr-2 text-gray-400"}),l(" 选择账户 ")],-1)),t("div",Da,[i(t("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>d.value.nonClaudeCodeFallbackAccountId=s),class:"block w-full max-w-md rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-teal-500 focus:outline-none focus:ring-2 focus:ring-teal-500/20 dark:border-gray-500 dark:bg-gray-600 dark:text-white sm:text-sm",disabled:K.value,onChange:V},[t("option",Fa,v(K.value?"加载中...":"请选择账户"),1),(n(!0),o(R,null,_(z.value,s=>(n(),o("option",{key:s.id,value:s.id},[l(v(s.name||s.id)+" ",1),s.email?(n(),o(R,{key:0},[l(" ("+v(s.email)+")",1)],64)):b("",!0),s.isActive?b("",!0):(n(),o(R,{key:1},[l(" [已禁用]")],64))],8,ja))),128))],40,Va),[[Q,d.value.nonClaudeCodeFallbackAccountId]]),K.value?(n(),o("div",Pa,e[101]||(e[101]=[t("i",{class:"fas fa-spinner fa-spin text-gray-400"},null,-1)]))):b("",!0)]),e[103]||(e[103]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 选择一个账户作为非 Claude Code 客户端的降级目标 ",-1))])):b("",!0)])):b("",!0),e[104]||(e[104]=A('<div class="mt-4 rounded-lg bg-cyan-50 p-4 dark:bg-cyan-900/20" data-v-4daca4cb><div class="flex" data-v-4daca4cb><i class="fas fa-lightbulb mt-0.5 text-cyan-500" data-v-4daca4cb></i><div class="ml-3" data-v-4daca4cb><p class="text-sm text-cyan-700 dark:text-cyan-300" data-v-4daca4cb><strong data-v-4daca4cb>使用场景：</strong>将 Claude Code 客户端的请求路由到稳定账户， 非 Claude Code 客户端（如浏览器、第三方应用）的请求路由到指定的降级账户， 既保证核心用户体验，又支持其他客户端的使用。 </p></div></div></div>',1))])):b("",!0)]),t("div",La,[t("div",Oa,[e[107]||(e[107]=A('<div data-v-4daca4cb><div class="flex items-center" data-v-4daca4cb><div class="mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-lg" data-v-4daca4cb><i class="fas fa-link" data-v-4daca4cb></i></div><div data-v-4daca4cb><h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-4daca4cb> 强制会话绑定 </h2><p class="mt-1 text-sm text-gray-600 dark:text-gray-400" data-v-4daca4cb> 启用后，系统会将原始会话 ID 绑定到首次使用的账户，确保上下文的一致性 </p></div></div></div>',1)),t("label",Ra,[i(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>d.value.globalSessionBindingEnabled=s),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[P,d.value.globalSessionBindingEnabled]]),e[106]||(e[106]=t("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-purple-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-purple-800"},null,-1))])]),d.value.globalSessionBindingEnabled?(n(),o("div",Qa,[t("div",null,[e[108]||(e[108]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-clock mr-2 text-gray-400"}),l(" 绑定有效期（天） ")],-1)),i(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>d.value.sessionBindingTtlDays=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",max:"365",min:"1",placeholder:"30",type:"number",onChange:V},null,544),[[x,d.value.sessionBindingTtlDays,void 0,{number:!0}]]),e[109]||(e[109]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 会话绑定到账户后的有效时间，过期后会自动解除绑定 ",-1))]),t("div",null,[e[110]||(e[110]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-exclamation-triangle mr-2 text-gray-400"}),l(" 旧会话污染提示 ")],-1)),i(t("textarea",{"onUpdate:modelValue":e[20]||(e[20]=s=>d.value.sessionBindingErrorMessage=s),class:"mt-1 block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",placeholder:"你的本地session已污染，请清理后使用。",rows:"2",onChange:V},null,544),[[x,d.value.sessionBindingErrorMessage]]),e[111]||(e[111]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 当检测到为旧的sessionId且未在系统中有调度记录时提示，返回给客户端的错误消息 ",-1))])])):b("",!0),e[112]||(e[112]=A('<div class="mt-4 rounded-lg bg-purple-50 p-4 dark:bg-purple-900/20" data-v-4daca4cb><div class="flex" data-v-4daca4cb><i class="fas fa-lightbulb mt-0.5 text-purple-500" data-v-4daca4cb></i><div class="ml-3" data-v-4daca4cb><p class="text-sm text-purple-700 dark:text-purple-300" data-v-4daca4cb><strong data-v-4daca4cb>工作原理：</strong>系统会提取请求中的原始 session ID （来自 <code class="rounded bg-purple-100 px-1 dark:bg-purple-800" data-v-4daca4cb>metadata.user_id</code>）， 并将其与首次调度的账户绑定。后续使用相同 session ID 的请求将自动路由到同一账户。 </p><p class="mt-2 text-sm text-purple-700 dark:text-purple-300" data-v-4daca4cb><strong data-v-4daca4cb>新会话识别：</strong>如果绑定会话历史中没有该sessionId但请求中 <code class="rounded bg-purple-100 px-1 dark:bg-purple-800" data-v-4daca4cb>messages.length &gt; 1</code>， 系统会认为这是一个污染的会话并拒绝请求。 </p></div></div></div>',1))]),t("div",Na,[t("div",Wa,[e[114]||(e[114]=A('<div data-v-4daca4cb><div class="flex items-center" data-v-4daca4cb><div class="mr-3 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-cyan-500 to-teal-600 text-white shadow-lg" data-v-4daca4cb><i class="fas fa-list-ol" data-v-4daca4cb></i></div><div data-v-4daca4cb><h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200" data-v-4daca4cb> 用户消息串行队列 </h2><p class="mt-1 text-sm text-gray-600 dark:text-gray-400" data-v-4daca4cb> 启用后，同一账户的用户消息请求将串行执行，并在请求之间添加延迟，防止触发上游限流 </p></div></div></div>',1)),t("label",Ka,[i(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>d.value.userMessageQueueEnabled=s),class:"peer sr-only",type:"checkbox",onChange:V},null,544),[[P,d.value.userMessageQueueEnabled]]),e[113]||(e[113]=t("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-teal-500 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-teal-300 dark:border-gray-600 dark:bg-gray-700 dark:peer-focus:ring-teal-800"},null,-1))])]),d.value.userMessageQueueEnabled?(n(),o("div",$a,[t("div",null,[e[115]||(e[115]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-hourglass-half mr-2 text-gray-400"}),l(" 请求间隔（毫秒） ")],-1)),i(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>d.value.userMessageQueueDelayMs=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-teal-500 focus:outline-none focus:ring-2 focus:ring-teal-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",max:"10000",min:"0",placeholder:"200",type:"number",onChange:V},null,544),[[x,d.value.userMessageQueueDelayMs,void 0,{number:!0}]]),e[116]||(e[116]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 同一账户的用户消息请求之间的最小间隔时间（0-10000毫秒） ",-1))]),t("div",null,[e[117]||(e[117]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-stopwatch mr-2 text-gray-400"}),l(" 队列超时（毫秒） ")],-1)),i(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>d.value.userMessageQueueTimeoutMs=s),class:"mt-1 block w-full max-w-xs rounded-lg border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-teal-500 focus:outline-none focus:ring-2 focus:ring-teal-500/20 dark:border-gray-500 dark:bg-gray-700 dark:text-white sm:text-sm",max:"300000",min:"1000",placeholder:"30000",type:"number",onChange:V},null,544),[[x,d.value.userMessageQueueTimeoutMs,void 0,{number:!0}]]),e[118]||(e[118]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 请求在队列中等待的最大时间，超时将返回 503 错误（1000-300000毫秒） ",-1))])])):b("",!0),e[119]||(e[119]=A('<div class="mt-4 rounded-lg bg-teal-50 p-4 dark:bg-teal-900/20" data-v-4daca4cb><div class="flex" data-v-4daca4cb><i class="fas fa-info-circle mt-0.5 text-teal-500" data-v-4daca4cb></i><div class="ml-3" data-v-4daca4cb><p class="text-sm text-teal-700 dark:text-teal-300" data-v-4daca4cb><strong data-v-4daca4cb>工作原理：</strong>系统检测请求中最后一条消息的 <code class="rounded bg-teal-100 px-1 dark:bg-teal-800" data-v-4daca4cb>role</code> 是否为 <code class="rounded bg-teal-100 px-1 dark:bg-teal-800" data-v-4daca4cb>user</code>。用户消息请求需要排队串行执行，而工具调用结果、助手消息续传等不受此限制。 </p></div></div></div>',1))]),d.value.updatedAt?(n(),o("div",qa,[e[122]||(e[122]=t("i",{class:"fas fa-history mr-2"},null,-1)),l(" 最后更新："+v(f(G)(d.value.updatedAt))+" ",1),d.value.updatedBy?(n(),o("span",za,[e[120]||(e[120]=l(" 由 ",-1)),t("strong",null,v(d.value.updatedBy),1),e[121]||(e[121]=l(" 修改 ",-1))])):b("",!0)])):b("",!0)]))],512),[[Z,T.value==="claude"]])]))])]),O.value?(n(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm transition-all duration-300 ease-out",onClick:H},[t("div",{class:"relative mx-4 w-full max-w-2xl overflow-hidden rounded-2xl bg-white shadow-2xl transition-all duration-300 ease-out dark:bg-gray-800",onClick:e[45]||(e[45]=Ne(()=>{},["stop"]))},[t("div",Ha,[t("div",Ja,[t("div",Xa,[e[124]||(e[124]=t("div",{class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-lg"},[t("i",{class:"fas fa-bell"})],-1)),t("div",null,[t("h3",Ya,v(E.value?"编辑":"添加")+"通知平台 ",1),t("p",Ga," 配置"+v(E.value?"并更新":"新的")+"Webhook通知渠道 ",1)])]),t("button",{class:"rounded-lg p-2 text-gray-400 transition-colors hover:bg-gray-100 hover:text-gray-600 dark:hover:bg-gray-700 dark:hover:text-gray-300",onClick:H},e[125]||(e[125]=[t("i",{class:"fas fa-times text-lg"},null,-1)]))])]),t("div",Za,[t("div",_a,[t("div",null,[e[129]||(e[129]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-layer-group mr-2 text-gray-400"}),l(" 平台类型 ")],-1)),t("div",er,[i(t("select",{"onUpdate:modelValue":e[24]||(e[24]=s=>a.value.type=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white",disabled:E.value},e[126]||(e[126]=[A('<option value="wechat_work" data-v-4daca4cb>🟢 企业微信</option><option value="dingtalk" data-v-4daca4cb>🔵 钉钉</option><option value="feishu" data-v-4daca4cb>🟦 飞书</option><option value="slack" data-v-4daca4cb>🟣 Slack</option><option value="discord" data-v-4daca4cb>🟪 Discord</option><option value="telegram" data-v-4daca4cb>✈️ Telegram</option><option value="bark" data-v-4daca4cb>🔔 Bark</option><option value="smtp" data-v-4daca4cb>📧 邮件通知</option><option value="custom" data-v-4daca4cb>⚙️ 自定义</option>',9)]),8,tr),[[Q,a.value.type]]),e[127]||(e[127]=t("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[t("i",{class:"fas fa-chevron-down text-gray-400"})],-1))]),E.value?(n(),o("p",ar,e[128]||(e[128]=[t("i",{class:"fas fa-info-circle mr-1"},null,-1),l(" 编辑模式下不能更改平台类型 ",-1)]))):b("",!0)]),t("div",null,[e[130]||(e[130]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-tag mr-2 text-gray-400"}),l(" 名称 "),t("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),i(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>a.value.name=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：运维群通知、开发测试群",type:"text"},null,512),[[x,a.value.name]])]),a.value.type!=="bark"&&a.value.type!=="smtp"&&a.value.type!=="telegram"?(n(),o("div",rr,[e[134]||(e[134]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-link mr-2 text-gray-400"}),l(" Webhook URL "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),t("div",sr,[i(t("input",{"onUpdate:modelValue":e[26]||(e[26]=s=>a.value.url=s),class:j(["w-full rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",{"border-red-500 focus:border-red-500 focus:ring-red-500/20":g.value,"border-green-500 focus:border-green-500 focus:ring-green-500/20":m.value}]),placeholder:"https://...",required:"",type:"url",onInput:we},null,34),[[x,a.value.url]]),m.value?(n(),o("div",lr,e[131]||(e[131]=[t("i",{class:"fas fa-check-circle text-green-500"},null,-1)]))):b("",!0),g.value?(n(),o("div",or,e[132]||(e[132]=[t("i",{class:"fas fa-exclamation-circle text-red-500"},null,-1)]))):b("",!0)]),le(a.value.type)?(n(),o("div",nr,[e[133]||(e[133]=t("i",{class:"fas fa-info-circle mr-2 mt-0.5 text-blue-600 dark:text-blue-400"},null,-1)),t("p",dr,v(le(a.value.type)),1)])):b("",!0)])):b("",!0),a.value.type==="telegram"?(n(),o("div",ir,[t("div",null,[e[135]||(e[135]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-robot mr-2 text-gray-400"}),l(" Bot Token "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>a.value.botToken=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：123456789:ABCDEFghijk-xyz",required:"",type:"text"},null,512),[[x,a.value.botToken]]),e[136]||(e[136]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 在 Telegram 的 @BotFather 中创建机器人后获得的 Token ",-1))]),t("div",null,[e[137]||(e[137]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-comments mr-2 text-gray-400"}),l(" Chat ID "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[28]||(e[28]=s=>a.value.chatId=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：123456789 或 -1001234567890",required:"",type:"text"},null,512),[[x,a.value.chatId]]),e[138]||(e[138]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 可使用 @userinfobot、@RawDataBot 或 API 获取聊天/频道的 Chat ID ",-1))]),t("div",null,[e[139]||(e[139]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-globe mr-2 text-gray-400"}),l(" API 基础地址 "),t("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),i(t("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>a.value.apiBaseUrl=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认: https://api.telegram.org",type:"url"},null,512),[[x,a.value.apiBaseUrl]]),e[140]||(e[140]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 使用自建 Bot API 时可覆盖默认域名，需以 http 或 https 开头 ",-1))]),t("div",null,[e[141]||(e[141]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-route mr-2 text-gray-400"}),l(" 代理地址 "),t("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),i(t("input",{"onUpdate:modelValue":e[30]||(e[30]=s=>a.value.proxyUrl=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：socks5://user:pass@127.0.0.1:1080",type:"text"},null,512),[[x,a.value.proxyUrl]]),e[142]||(e[142]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 支持 http、https、socks4/4a/5 代理，留空则直接连接 Telegram 官方 API ",-1))]),e[143]||(e[143]=t("div",{class:"flex items-start rounded-lg bg-blue-50 p-3 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-300"},[t("i",{class:"fas fa-info-circle mr-2 mt-0.5"}),t("div",null,"机器人需先加入对应群组或频道并授予发送消息权限，通知会以纯文本方式发送。")],-1))])):b("",!0),a.value.type==="bark"?(n(),o("div",ur,[t("div",null,[e[144]||(e[144]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-key mr-2 text-gray-400"}),l(" 设备密钥 (Device Key) "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[31]||(e[31]=s=>a.value.deviceKey=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如：aBcDeFgHiJkLmNoPqRsTuVwX",required:"",type:"text"},null,512),[[x,a.value.deviceKey]]),e[145]||(e[145]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 在Bark App中查看您的推送密钥 ",-1))]),t("div",null,[e[146]||(e[146]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-server mr-2 text-gray-400"}),l(" 服务器地址 "),t("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),i(t("input",{"onUpdate:modelValue":e[32]||(e[32]=s=>a.value.serverUrl=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认: https://api.day.app/push",type:"url"},null,512),[[x,a.value.serverUrl]])]),t("div",null,[e[148]||(e[148]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-flag mr-2 text-gray-400"}),l(" 通知级别 ")],-1)),i(t("select",{"onUpdate:modelValue":e[33]||(e[33]=s=>a.value.level=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},e[147]||(e[147]=[A('<option value="" data-v-4daca4cb>自动（根据通知类型）</option><option value="passive" data-v-4daca4cb>被动</option><option value="active" data-v-4daca4cb>默认</option><option value="timeSensitive" data-v-4daca4cb>时效性</option><option value="critical" data-v-4daca4cb>紧急</option>',5)]),512),[[Q,a.value.level]])]),t("div",null,[e[150]||(e[150]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-volume-up mr-2 text-gray-400"}),l(" 通知声音 ")],-1)),i(t("select",{"onUpdate:modelValue":e[34]||(e[34]=s=>a.value.sound=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},e[149]||(e[149]=[A('<option value="" data-v-4daca4cb>自动（根据通知类型）</option><option value="default" data-v-4daca4cb>默认</option><option value="alarm" data-v-4daca4cb>警报</option><option value="bell" data-v-4daca4cb>铃声</option><option value="birdsong" data-v-4daca4cb>鸟鸣</option><option value="electronic" data-v-4daca4cb>电子音</option><option value="glass" data-v-4daca4cb>玻璃</option><option value="horn" data-v-4daca4cb>喇叭</option><option value="silence" data-v-4daca4cb>静音</option>',9)]),512),[[Q,a.value.sound]])]),t("div",null,[e[151]||(e[151]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-folder mr-2 text-gray-400"}),l(" 通知分组 "),t("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),i(t("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>a.value.group=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认: claude-relay",type:"text"},null,512),[[x,a.value.group]])]),e[152]||(e[152]=t("div",{class:"mt-2 flex items-start rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[t("i",{class:"fas fa-info-circle mr-2 mt-0.5 text-blue-600 dark:text-blue-400"}),t("div",{class:"text-sm text-blue-700 dark:text-blue-300"},[t("p",null,"1. 在iPhone上安装Bark App"),t("p",null,"2. 打开App获取您的设备密钥"),t("p",null,"3. 将密钥粘贴到上方输入框")])],-1))])):b("",!0),a.value.type==="smtp"?(n(),o("div",cr,[t("div",null,[e[153]||(e[153]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-server mr-2 text-gray-400"}),l(" SMTP 服务器 "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>a.value.host=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"例如: smtp.gmail.com",required:"",type:"text"},null,512),[[x,a.value.host]])]),t("div",gr,[t("div",null,[e[154]||(e[154]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-plug mr-2 text-gray-400"}),l(" 端口 ")],-1)),i(t("input",{"onUpdate:modelValue":e[37]||(e[37]=s=>a.value.port=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white",max:"65535",min:"1",placeholder:"587",type:"number"},null,512),[[x,a.value.port,void 0,{number:!0}]]),e[155]||(e[155]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 默认: 587 (TLS) 或 465 (SSL) ",-1))]),t("div",null,[e[157]||(e[157]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-shield-alt mr-2 text-gray-400"}),l(" 加密方式 ")],-1)),i(t("select",{"onUpdate:modelValue":e[38]||(e[38]=s=>a.value.secure=s),class:"w-full appearance-none rounded-xl border border-gray-300 bg-white px-4 py-3 pr-10 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},e[156]||(e[156]=[t("option",{value:!1},"STARTTLS (端口587)",-1),t("option",{value:!0},"SSL/TLS (端口465)",-1)]),512),[[Q,a.value.secure]])])]),t("div",null,[e[158]||(e[158]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-user mr-2 text-gray-400"}),l(" 用户名 "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[39]||(e[39]=s=>a.value.user=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"user@example.com",required:"",type:"email"},null,512),[[x,a.value.user]])]),t("div",null,[e[159]||(e[159]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-lock mr-2 text-gray-400"}),l(" 密码 / 应用密码 "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[40]||(e[40]=s=>a.value.pass=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"邮箱密码或应用专用密码",required:"",type:"password"},null,512),[[x,a.value.pass]]),e[160]||(e[160]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," 建议使用应用专用密码，而非邮箱登录密码 ",-1))]),t("div",null,[e[161]||(e[161]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-paper-plane mr-2 text-gray-400"}),l(" 发件人邮箱 "),t("span",{class:"ml-2 text-xs text-gray-500"},"(可选)")],-1)),i(t("input",{"onUpdate:modelValue":e[41]||(e[41]=s=>a.value.from=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"默认使用用户名邮箱",type:"email"},null,512),[[x,a.value.from]])]),t("div",null,[e[162]||(e[162]=t("label",{class:"mb-2 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-envelope mr-2 text-gray-400"}),l(" 收件人邮箱 "),t("span",{class:"ml-1 text-xs text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[42]||(e[42]=s=>a.value.to=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder:text-gray-500",placeholder:"admin@example.com",required:"",type:"email"},null,512),[[x,a.value.to]]),e[163]||(e[163]=t("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"接收通知的邮箱地址",-1))])])):b("",!0),a.value.type==="dingtalk"||a.value.type==="feishu"?(n(),o("div",br,[t("div",fr,[t("div",pr,[t("label",yr,[i(t("input",{id:"enableSign","onUpdate:modelValue":e[43]||(e[43]=s=>a.value.enableSign=s),class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0",type:"checkbox"},null,512),[[P,a.value.enableSign]]),e[164]||(e[164]=t("span",{class:"ml-3 flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},[t("i",{class:"fas fa-shield-alt mr-2 text-gray-400"}),l(" 启用签名验证 ")],-1))]),a.value.enableSign?(n(),o("span",vr," 已启用 ")):b("",!0)]),Oe(Qe,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-2"},{default:Re(()=>[a.value.enableSign?(n(),o("div",xr,[e[165]||(e[165]=t("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," 签名密钥 ",-1)),i(t("input",{"onUpdate:modelValue":e[44]||(e[44]=s=>a.value.secret=s),class:"w-full rounded-xl border border-gray-300 bg-white px-4 py-3 font-mono text-sm text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-600 dark:bg-gray-800 dark:text-white dark:placeholder:text-gray-500",placeholder:"SEC...",type:"text"},null,512),[[x,a.value.secret]])])):b("",!0)]),_:1})])])):b("",!0)])]),t("div",mr,[t("div",kr,[e[167]||(e[167]=t("div",{class:"text-xs text-gray-500 dark:text-gray-400"},[t("i",{class:"fas fa-asterisk mr-1 text-red-500"}),l(" 必填项 ")],-1)),t("div",hr,[t("button",{class:"group flex items-center rounded-xl border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 shadow-sm transition-all hover:bg-gray-50 hover:shadow-md dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",onClick:H},e[166]||(e[166]=[t("i",{class:"fas fa-times mr-2 transition-transform group-hover:scale-110"},null,-1),l(" 取消 ",-1)])),t("button",{class:"group flex items-center rounded-xl border border-blue-200 bg-blue-50 px-4 py-2.5 text-sm font-medium text-blue-700 shadow-sm transition-all hover:bg-blue-100 hover:shadow-md dark:border-blue-800 dark:bg-blue-900/50 dark:text-blue-300 dark:hover:bg-blue-900/70",disabled:F.value,onClick:Ie},[t("i",{class:j(["mr-2 transition-transform",F.value?"fas fa-spinner fa-spin":"fas fa-vial group-hover:scale-110"])},null,2),l(" "+v(F.value?"测试中...":"测试连接"),1)],8,wr),t("button",{class:"group flex items-center rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-5 py-2.5 text-sm font-medium text-white shadow-md transition-all hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-500",disabled:!me.value||D.value,onClick:Ce},[t("i",{class:j(["mr-2 transition-transform",D.value?"fas fa-spinner fa-spin":"fas fa-save group-hover:scale-110"])},null,2),l(" "+v(D.value?"保存中...":E.value?"保存修改":"添加平台"),1)],8,Cr)])])])])])):b("",!0)],64))}}),Br=We(Tr,[["__scopeId","data-v-4daca4cb"]]);export{Br as default};
